"use strict";(self.webpackChunkspiceaidocs=self.webpackChunkspiceaidocs||[]).push([[3503],{8179:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>a});var i=t(4848),r=t(8453);const o={title:"SharePoint Data Connector",sidebar_label:"SharePoint Data Connector",description:"SharePoint Data Connector Documentation",pagination_prev:null},s=void 0,c={id:"components/data-connectors/sharepoint",title:"SharePoint Data Connector",description:"SharePoint Data Connector Documentation",source:"@site/docs/components/data-connectors/sharepoint.md",sourceDirName:"components/data-connectors",slug:"/components/data-connectors/sharepoint",permalink:"/components/data-connectors/sharepoint",draft:!1,unlisted:!1,editUrl:"https://github.com/spiceai/docs/tree/trunk/spiceaidocs/docs/components/data-connectors/sharepoint.md",tags:[],version:"current",frontMatter:{title:"SharePoint Data Connector",sidebar_label:"SharePoint Data Connector",description:"SharePoint Data Connector Documentation",pagination_prev:null},sidebar:"docsSidebar",next:{title:"Snowflake Data Connector",permalink:"/components/data-connectors/snowflake"}},d={},a=[{value:"Example",id:"example",level:4},{value:"Configuration",id:"configuration",level:2},{value:"Parameters",id:"parameters",level:3},{value:"<code>from</code> formats",id:"from-formats",level:3},{value:"Drives",id:"drives",level:4},{value:"Subpaths",id:"subpaths",level:4},{value:"Authentication",id:"authentication",level:2},{value:"Creating an Enterprise Application",id:"creating-an-enterprise-application",level:3},{value:"Default Spice Application",id:"default-spice-application",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"The SharePoint Data Connector enables federated SQL queries on documents stored in SharePoint."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"datasets:\n  - from: sharepoint:drive:Documents/path:/top_secrets/\n    name: important_documents\n    params:\n      sharepoint_client_id: ${secrets:SPICE_SHAREPOINT_CLIENT_ID}\n      sharepoint_tenant_id: ${secrets:SPICE_SHAREPOINT_TENANT_ID}\n      sharepoint_client_secret: ${secrets:SPICE_SHAREPOINT_CLIENT_SECRET}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM important_documents limit 1\n"})}),"\n",(0,i.jsx)(n.p,{children:"Returns"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'\n[\n    {\n        "created_by_id": "cbccd193-f9f1-4603-b01d-ff6f3e6f2108",\n        "created_by_name": "Jack Eadie",\n        "created_at": "2024-09-09T04:57:00",\n        "c_tag": "\\"c:{BD4D130F-2C95-4E59-9F93-85BD0A9E1B19},1\\"",\n        "e_tag": "\\"{BD4D130F-2C95-4E59-9F93-85BD0A9E1B19},1\\"",\n        "id": "01YRH3MPAPCNG33FJMLFHJ7E4FXUFJ4GYZ",\n        "last_modified_by_id": "cbccd193-f9f1-4603-b01d-ff6f3e6f2108",\n        "last_modified_by_name": "Jack Eadie",\n        "last_modified_at": "2024-09-09T04:57:00",\n        "name": "ngx_google_perftools_module.md",\n        "size": 959,\n        "web_url": "https://spiceai.sharepoint.com/Shared%20Documents/md/ngx_google_perftools_module.md",\n        "content": "# Module ngx_google_perftools_module\\n\\nThe `ngx_google_perftools_module` module (0.6.29) enables profiling of nginx worker processes using [Google Performance Tools](https://github.com/gperftools/gperftools). The module is intended for nginx developers.\\n\\nThis module is not built by default, it should be enabled with the `--with-google_perftools_module` configuration parameter.\\n\\n> **Note:** This module requires the [gperftools](https://github.com/gperftools/gperftools) library.\\n\\n## Example Configuration\\n\\n```nginx\\ngoogle_perftools_profiles /path/to/profile;\\n```\\n\\nProfiles will be stored as `/path/to/profile.<worker_pid>`.\\n\\n## Directives\\n\\n### google_perftools_profiles\\n\\n- **Syntax:** `google_perftools_profiles file;`\\n- **Default:** \u2014\\n- **Context:** `main`\\n\\nSets a file name that keeps profiling information of nginx worker process. The ID of the worker process is always a part of the file name and is appended to the end of the file name, after a dot.\\n"\n    }\n]\n'})}),"\n",(0,i.jsx)(n.admonition,{title:"Limitations",type:"warning",children:(0,i.jsxs)(n.p,{children:["The sharepoint connector does not yet support creating a dataset from a single file (e.g. an Excel spreadsheet). Datasets must be created from a folder of documents (see ",(0,i.jsx)(n.a,{href:"/components/data-connectors/#document-support",children:"Document Support"}),")."]})}),"\n",(0,i.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Name"}),(0,i.jsx)(n.th,{children:"Required?"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"sharepoint_client_id"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Yes"})}),(0,i.jsx)(n.td,{children:"The client ID of the Azure AD (Entra) application"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"sharepoint_tenant_id"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Yes"})}),(0,i.jsx)(n.td,{children:"The tenant ID of the Azure AD (Entra) application."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"sharepoint_client_secret"})}),(0,i.jsx)(n.td,{children:"Optional"}),(0,i.jsx)(n.td,{children:"For service principal authentication. The client secret of the Azure AD (Entra) application."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"sharepoint_client_code"})}),(0,i.jsx)(n.td,{children:"Optional"}),(0,i.jsxs)(n.td,{children:["For user authentication. The authorization code obtained from the OAuth2 flow (see ",(0,i.jsx)(n.code,{children:"spice login sharepoint"})," ",(0,i.jsx)(n.a,{href:"/cli/reference/login",children:"docs"}),")."]})]})]})]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Only one of ",(0,i.jsx)(n.code,{children:"sharepoint_client_secret"})," or ",(0,i.jsx)(n.code,{children:"sharepoint_auth_code"})," is allowed."]})}),"\n",(0,i.jsxs)(n.h3,{id:"from-formats",children:[(0,i.jsx)(n.code,{children:"from"})," formats"]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"from"})," field in a SharePoint dataset takes the following format:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"from: 'sharepoint:<drive_type>:<drive_id>/<subpath_type>:<subpath_value>'\n"})}),"\n",(0,i.jsx)(n.h4,{id:"drives",children:"Drives"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"drive_type"})," in a SharePoint Connector ",(0,i.jsx)(n.code,{children:"from"})," field supports the following types:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Drive Type"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Example"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"drive"})}),(0,i.jsx)(n.td,{children:"The SharePoint drive's name"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"from: sharepoint:drive:Documents/..."})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"driveID"})}),(0,i.jsx)(n.td,{children:"The SharePoint drive's ID"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"from: sharepoint:driveId:b!Mh8opUGD80ec7zGXgX9r/..."})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"site"})}),(0,i.jsx)(n.td,{children:"A SharePoint site's name"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"from: sharepoint:site:MySite/..."})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"siteID"})}),(0,i.jsx)(n.td,{children:"A SharePoint site's ID"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"from: sharepoint:siteId:b!Mh8opUGD80ec7zGXgX9r/..."})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"group"})}),(0,i.jsx)(n.td,{children:"A SharePoint group's name"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"from: sharepoint:group:MyGroup/..."})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"groupId"})}),(0,i.jsx)(n.td,{children:"A SharePoint group's ID"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"from: sharepoint:groupId:b!Mh8opUGD80ec7zGXgX9r/..."})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"me"})}),(0,i.jsx)(n.td,{children:"A user's OneDrive"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"from: sharepoint:me/..."})})]})]})]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["For the ",(0,i.jsx)(n.code,{children:"me"})," drive type the user is identified based on ",(0,i.jsx)(n.code,{children:"sharepoint_client_code"})," and cannot be used with ",(0,i.jsx)(n.code,{children:"sharepoint_client_secret"})]})}),"\n",(0,i.jsxs)(n.p,{children:["For a name-based ",(0,i.jsx)(n.code,{children:"drive_id"}),", the connector will attempt to resolve the name to an ID at startup."]}),"\n",(0,i.jsx)(n.h4,{id:"subpaths",children:"Subpaths"}),"\n",(0,i.jsx)(n.p,{children:"Within a drive, the SharePoint connector can load documents from:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Example"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"The root of the drive"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"from: sharepoint:me/root"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"A specific path within the drive"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"from: sharepoint:drive:Documents/path:/top_secrets"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"A specific folder ID"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"from: sharepoint:group:MyGroup/id:01QM2NJSNHBISUGQ52P5AJQ3CBNOXDMVNT"})})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,i.jsxs)(n.p,{children:["As outlined in the ",(0,i.jsx)(n.a,{href:"#parameters",children:"connector parameters"}),", the SharePoint connector supports two types of authentication:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Service principal authentication, by setting the ",(0,i.jsx)(n.code,{children:"sharepoint_client_secret"})," parameter."]}),"\n",(0,i.jsxs)(n.li,{children:["User authentication, by setting the ",(0,i.jsx)(n.code,{children:"sharepoint_auth_code"})," parameter. Generally this is obtained by running ",(0,i.jsx)(n.code,{children:"spice login sharepoint"})," and following the OAuth2 flow."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"creating-an-enterprise-application",children:"Creating an Enterprise Application"}),"\n",(0,i.jsxs)(n.p,{children:["To use the SharePoint connector with service principal authentication, you will need to create an Azure AD application and grant it the necessary permissions. This will also support OAuth2 authentication for users within the tenant (i.e. ",(0,i.jsx)(n.code,{children:"sharepoint_auth_code"}),")."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Create a new Azure AD application in the ",(0,i.jsx)(n.a,{href:"https://portal.azure.com/#view/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/~/Overview",children:"Azure portal"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Under the application's ",(0,i.jsx)(n.code,{children:"API permissions"}),", add the following permissions: ",(0,i.jsx)(n.code,{children:"Sites.Read.All"}),", ",(0,i.jsx)(n.code,{children:"Files.Read.All"}),", ",(0,i.jsx)(n.code,{children:"User.Read"}),", ",(0,i.jsx)(n.code,{children:"GroupMember.Read.All"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"For service principal authentication, Application permissions are required."}),"\n",(0,i.jsx)(n.li,{children:"For user authentication, only delegated permissions are required."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Add ",(0,i.jsx)(n.code,{children:"sharepoint_client_id"})," (from the ",(0,i.jsx)(n.code,{children:"Application (Client) ID"})," field) and ",(0,i.jsx)(n.code,{children:"sharepoint_tenant_id"})," to the connector configuration."]}),"\n",(0,i.jsxs)(n.li,{children:["(For service principal authentication): Under the application's ",(0,i.jsx)(n.code,{children:"Certificates & secrets"}),", create a new client secret. Use this for the ",(0,i.jsx)(n.code,{children:"sharepoint_client_secret"})," parameter."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"default-spice-application",children:"Default Spice Application"}),"\n",(0,i.jsx)(n.p,{children:"For your convenience, Spice AI maintains a default Entra (Azure AD) application that can be used for authentication against your SharePoint instance. This application requires OAuth2 authentication. To use it:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"datasets:\n  - from: sharepoint:me/root # Set the drive and subpath as needed.\n    name: my_data\n    params:\n      sharepoint_client_id: f2b3116e-b4c4-464f-80ec-73cd9d9886b4\n      sharepoint_tenant_id: #${env:TENANT_ID}\n      sharepoint_auth_code: ${secrets:SPICE_SHAREPOINT_AUTH_CODE}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["And set the ",(0,i.jsx)(n.code,{children:"SPICE_SHAREPOINT_AUTH_CODE"})," secret via:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"spice login sharepoint --tenant-id $TENANT_ID --client-id f2b3116e-b4c4-464f-80ec-73cd9d9886b4\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>c});var i=t(6540);const r={},o=i.createContext(r);function s(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);