"use strict";(self.webpackChunkspiceaidocs=self.webpackChunkspiceaidocs||[]).push([[312],{7656:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var r=s(4848),t=s(8453),c=s(3514);const o={title:"Secret Stores",sidebar_label:"Secret Stores",description:"",sidebar_position:4,pagination_prev:null,pagination_next:null},i=void 0,a={id:"components/secret-stores/index",title:"Secret Stores",description:"",source:"@site/docs/components/secret-stores/index.md",sourceDirName:"components/secret-stores",slug:"/components/secret-stores/",permalink:"/components/secret-stores/",draft:!1,unlisted:!1,editUrl:"https://github.com/spiceai/docs/tree/trunk/spiceaidocs/docs/components/secret-stores/index.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"Secret Stores",sidebar_label:"Secret Stores",description:"",sidebar_position:4,pagination_prev:null,pagination_next:null},sidebar:"docsSidebar"},l={},d=[{value:"Default",id:"default",level:3},{value:"Configured Secret Stores",id:"configured-secret-stores",level:2},{value:"Using referenced secrets in component parameters",id:"using-referenced-secrets-in-component-parameters",level:2},{value:"Load secrets from multiple secret stores",id:"load-secrets-from-multiple-secret-stores",level:2},{value:"Secret Stores",id:"secret-stores",level:2}];function m(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["A Secret Store is a location where ",(0,r.jsx)(n.code,{children:"secrets"})," are stored and can be used to store sensitive data, like passwords, tokens, and secret keys."]}),"\n",(0,r.jsxs)(n.p,{children:["Spice supports secret stores: ",(0,r.jsx)(n.a,{href:"/components/secret-stores/env/",children:(0,r.jsx)(n.code,{children:"env"})}),", ",(0,r.jsx)(n.a,{href:"/components/secret-stores/kubernetes/",children:(0,r.jsx)(n.code,{children:"kubernetes"})}),", ",(0,r.jsx)(n.a,{href:"/components/secret-stores/keyring/",children:(0,r.jsx)(n.code,{children:"keyring"})})," and ",(0,r.jsx)(n.a,{href:"/components/secret-stores/aws-secrets-manager/",children:(0,r.jsx)(n.code,{children:"aws_secrets_manager"})}),". The ",(0,r.jsx)(n.code,{children:"env"})," secret store is loaded by default."]}),"\n",(0,r.jsx)(n.h3,{id:"default",children:"Default"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"env"})," secret store is loaded by default. It reads secrets from environment variables and any ",(0,r.jsx)(n.code,{children:".env.local"})," or ",(0,r.jsx)(n.code,{children:".env"})," files in the project directory."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"secrets:\n  - from: env\n    name: env\n"})}),"\n",(0,r.jsx)(n.h2,{id:"configured-secret-stores",children:"Configured Secret Stores"}),"\n",(0,r.jsxs)(n.p,{children:["Secret Stores can be configured using the ",(0,r.jsx)(n.code,{children:"secrets"})," section of the ",(0,r.jsx)(n.code,{children:"spicepod.yml"})," file."]}),"\n",(0,r.jsxs)(n.p,{children:["The Secret Store type and name are specified using the ",(0,r.jsx)(n.code,{children:"from"})," and ",(0,r.jsx)(n.code,{children:"name"})," fields. The ",(0,r.jsx)(n.code,{children:"name"})," can be referenced by other components, like datasets or models. Some Secret Stores support adding a selector delimited by a colon (",(0,r.jsx)(n.code,{children:":"}),"), For example, when using the Kubernetes Secret Store, ",(0,r.jsx)(n.code,{children:"from: kubernetes:my_secret"})," selects and enables the ",(0,r.jsx)(n.code,{children:"my_secret"})," secret only to be referenced."]}),"\n",(0,r.jsxs)(n.p,{children:["Additional parameters may be specified in the ",(0,r.jsx)(n.code,{children:"params"})," field, which are typically specific to the secret store type."]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"secrets:\n  - from: kubernetes:my_secret\n    name: k8s\n  - from: env\n    name: env\n"})}),"\n",(0,r.jsx)(n.h2,{id:"using-referenced-secrets-in-component-parameters",children:"Using referenced secrets in component parameters"}),"\n",(0,r.jsxs)(n.p,{children:["Secrets may be used by components with the syntax ",(0,r.jsx)(n.code,{children:"${<secret_store_name>:<key_name>}"}),". For example, to reference a secret stored as an environment variable named ",(0,r.jsx)(n.code,{children:"MY_SECRET"})," in the ",(0,r.jsx)(n.code,{children:"env"})," secret store, use ",(0,r.jsx)(n.code,{children:"${env:MY_SECRET}"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"datasets:\n  - from: postgres:my_table\n    name: my_table\n    params:\n      pg_host: localhost\n      pg_port: 5432\n      pg_user: ${env:PG_USER}\n      pg_pass: ${env:FOO_PASSWORD} # The environment variable name may differ from the parameter name.\n"})}),"\n",(0,r.jsx)(n.p,{children:"This syntax also works within a larger string, like a connection string:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"datasets:\n  - from: mysql:my_table\n    name: my_table\n    params:\n      mysql_connection_string: mysql://${env:USER}:${env:PASSWORD}@localhost:3306/mysql_db\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"<secret_store_name>"})," value in ",(0,r.jsx)(n.code,{children:"${<secret_store_name>:<key_name>}"})," is the ",(0,r.jsx)(n.code,{children:"name"})," value defined in the secret store configuration. This can be renamed to any value."]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"secrets:\n  - from: env\n    name: my_env\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"datasets:\n  - from: postgres:my_table\n    name: my_table\n    params:\n      pg_host: localhost\n      pg_port: 5432\n      pg_user: ${my_env:PG_USER}\n      pg_pass: ${my_env:PG_PASS}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"load-secrets-from-multiple-secret-stores",children:"Load secrets from multiple secret stores"}),"\n",(0,r.jsxs)(n.p,{children:["Spice supports configuring multiple secret stores which are loaded in the order they are defined in the ",(0,r.jsx)(n.code,{children:"secrets"})," section of the ",(0,r.jsx)(n.code,{children:"spicepod.yml"})," configuration file. If a secret is defined in multiple secret stores, the secret store defined last will take precedence."]}),"\n",(0,r.jsxs)(n.p,{children:["To load a secret from any of the configured secret stores in precedence order, use the ",(0,r.jsx)(n.code,{children:"${secrets:<key_name>}"})," syntax."]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"secrets:\n  - from: env\n    name: env\n  - from: keyring\n    name: keyring\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"datasets:\n  - from: postgres:my_table\n    name: my_table\n    params:\n      pg_host: localhost\n      pg_port: 5432\n      pg_user: ${secrets:pg_user}\n      pg_pass: ${secrets:pg_pass}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["In this example, the runtime would look for ",(0,r.jsx)(n.code,{children:"pg_user"})," and ",(0,r.jsx)(n.code,{children:"pg_pass"})," in the ",(0,r.jsx)(n.code,{children:"keyring"})," secret store first and then in the ",(0,r.jsx)(n.code,{children:"env"})," secret store. The ",(0,r.jsx)(n.code,{children:"<key_name>"})," value in ",(0,r.jsx)(n.code,{children:"${secrets:<key_name>}"})," is automatically uppercased for the ",(0,r.jsx)(n.code,{children:"env"})," secret store."]}),"\n",(0,r.jsxs)(n.p,{children:["To override the ",(0,r.jsx)(n.code,{children:"keyring"})," secret store secrets with environment variables, re-order the secret stores in the configuration file:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"secrets:\n  - from: keyring\n    name: keyring\n  - from: env\n    name: env\n"})}),"\n",(0,r.jsx)(n.h2,{id:"secret-stores",children:"Secret Stores"}),"\n","\n",(0,r.jsx)(c.A,{})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(m,{...e})}):m(e)}},3514:(e,n,s)=>{s.d(n,{A:()=>j});s(6540);var r=s(4164),t=s(4142),c=s(8774),o=s(5846),i=s(6654),a=s(1312),l=s(1107);const d={cardContainer:"cardContainer_fWXF",cardTitle:"cardTitle_rnsV",cardDescription:"cardDescription_PWke"};var m=s(4848);function h(e){let{href:n,children:s}=e;return(0,m.jsx)(c.A,{href:n,className:(0,r.A)("card padding--lg",d.cardContainer),children:s})}function p(e){let{href:n,icon:s,title:t,description:c}=e;return(0,m.jsxs)(h,{href:n,children:[(0,m.jsxs)(l.A,{as:"h2",className:(0,r.A)("text--truncate",d.cardTitle),title:t,children:[s," ",t]}),c&&(0,m.jsx)("p",{className:(0,r.A)("text--truncate",d.cardDescription),title:c,children:c})]})}function u(e){let{item:n}=e;const s=(0,t.Nr)(n),r=function(){const{selectMessage:e}=(0,o.W)();return n=>e(n,(0,a.T)({message:"1 item|{count} items",id:"theme.docs.DocCard.categoryDescription.plurals",description:"The default description for a category card in the generated index about how many items this category includes"},{count:n}))}();return s?(0,m.jsx)(p,{href:s,icon:"\ud83d\uddc3\ufe0f",title:n.label,description:n.description??r(n.items.length)}):null}function x(e){let{item:n}=e;const s=(0,i.A)(n.href)?"\ud83d\udcc4\ufe0f":"\ud83d\udd17",r=(0,t.cC)(n.docId??void 0);return(0,m.jsx)(p,{href:n.href,icon:s,title:n.label,description:n.description??r?.description})}function f(e){let{item:n}=e;switch(n.type){case"link":return(0,m.jsx)(x,{item:n});case"category":return(0,m.jsx)(u,{item:n});default:throw new Error(`unknown item type ${JSON.stringify(n)}`)}}function g(e){let{className:n}=e;const s=(0,t.$S)();return(0,m.jsx)(j,{items:s.items,className:n})}function j(e){const{items:n,className:s}=e;if(!n)return(0,m.jsx)(g,{...e});const c=(0,t.d1)(n);return(0,m.jsx)("section",{className:(0,r.A)("row",s),children:c.map(((e,n)=>(0,m.jsx)("article",{className:"col col--6 margin-bottom--lg",children:(0,m.jsx)(f,{item:e})},n)))})}},5846:(e,n,s)=>{s.d(n,{W:()=>l});var r=s(6540),t=s(4586);const c=["zero","one","two","few","many","other"];function o(e){return c.filter((n=>e.includes(n)))}const i={locale:"en",pluralForms:o(["one","other"]),select:e=>1===e?"one":"other"};function a(){const{i18n:{currentLocale:e}}=(0,t.A)();return(0,r.useMemo)((()=>{try{return function(e){const n=new Intl.PluralRules(e);return{locale:e,pluralForms:o(n.resolvedOptions().pluralCategories),select:e=>n.select(e)}}(e)}catch(n){return console.error(`Failed to use Intl.PluralRules for locale "${e}".\nDocusaurus will fallback to the default (English) implementation.\nError: ${n.message}\n`),i}}),[e])}function l(){const e=a();return{selectMessage:(n,s)=>function(e,n,s){const r=e.split("|");if(1===r.length)return r[0];r.length>s.pluralForms.length&&console.error(`For locale=${s.locale}, a maximum of ${s.pluralForms.length} plural forms are expected (${s.pluralForms.join(",")}), but the message contains ${r.length}: ${e}`);const t=s.select(n),c=s.pluralForms.indexOf(t);return r[Math.min(c,r.length-1)]}(s,n,e)}}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>i});var r=s(6540);const t={},c=r.createContext(t);function o(e){const n=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);