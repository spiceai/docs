"use strict";(self.webpackChunkspiceaidocs=self.webpackChunkspiceaidocs||[]).push([[3503],{8179:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>l});var t=i(4848),o=i(8453);const r={title:"Sharepoint Data Connector",sidebar_label:"Sharepoint Data Connector",description:"Sharepoint Data Connector Documentation",pagination_prev:null},s=void 0,a={id:"components/data-connectors/sharepoint",title:"Sharepoint Data Connector",description:"Sharepoint Data Connector Documentation",source:"@site/docs/components/data-connectors/sharepoint.md",sourceDirName:"components/data-connectors",slug:"/components/data-connectors/sharepoint",permalink:"/components/data-connectors/sharepoint",draft:!1,unlisted:!1,editUrl:"https://github.com/spiceai/docs/tree/trunk/spiceaidocs/docs/components/data-connectors/sharepoint.md",tags:[],version:"current",frontMatter:{title:"Sharepoint Data Connector",sidebar_label:"Sharepoint Data Connector",description:"Sharepoint Data Connector Documentation",pagination_prev:null},sidebar:"docsSidebar",next:{title:"Snowflake Data Connector",permalink:"/components/data-connectors/snowflake"}},c={},l=[{value:"Example",id:"example",level:4},{value:"Configuration",id:"configuration",level:2},{value:"Parameters",id:"parameters",level:3},{value:"<code>from</code> formats",id:"from-formats",level:3},{value:"Drives",id:"drives",level:4},{value:"Subpaths",id:"subpaths",level:4},{value:"Authentication",id:"authentication",level:2},{value:"Creating an Enterprise Application",id:"creating-an-enterprise-application",level:3},{value:"Default Spice Application",id:"default-spice-application",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"The Sharepoint Data Connector enables federated SQL queries on documents stored in Sharepoint."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"datasets:\n  - from: sharepoint:drive:Documents/path:/top_secrets/\n    name: important_documents\n    params:\n      sharepoint_client_id: ${secrets:SPICE_SHAREPOINT_CLIENT_ID}\n      sharepoint_tenant_id: ${secrets:SPICE_SHAREPOINT_TENANT_ID}\n      sharepoint_client_secret: ${secrets:SPICE_SHAREPOINT_CLIENT_SECRET}\n"})}),"\n",(0,t.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM important_documents limit 1\n"})}),"\n",(0,t.jsx)(n.p,{children:"Returns"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'\n[\n    {\n        "created_by_id": "cbccd193-f9f1-4603-b01d-ff6f3e6f2108",\n        "created_by_name": "Jack Eadie",\n        "created_at": "2024-09-09T04:57:00",\n        "c_tag": "\\"c:{BD4D130F-2C95-4E59-9F93-85BD0A9E1B19},1\\"",\n        "e_tag": "\\"{BD4D130F-2C95-4E59-9F93-85BD0A9E1B19},1\\"",\n        "id": "01YRH3MPAPCNG33FJMLFHJ7E4FXUFJ4GYZ",\n        "last_modified_by_id": "cbccd193-f9f1-4603-b01d-ff6f3e6f2108",\n        "last_modified_by_name": "Jack Eadie",\n        "last_modified_at": "2024-09-09T04:57:00",\n        "name": "ngx_google_perftools_module.md",\n        "size": 959,\n        "web_url": "https://spiceai.sharepoint.com/Shared%20Documents/md/ngx_google_perftools_module.md",\n        "content": "# Module ngx_google_perftools_module\\n\\nThe `ngx_google_perftools_module` module (0.6.29) enables profiling of nginx worker processes using [Google Performance Tools](https://github.com/gperftools/gperftools). The module is intended for nginx developers.\\n\\nThis module is not built by default, it should be enabled with the `--with-google_perftools_module` configuration parameter.\\n\\n> **Note:** This module requires the [gperftools](https://github.com/gperftools/gperftools) library.\\n\\n## Example Configuration\\n\\n```nginx\\ngoogle_perftools_profiles /path/to/profile;\\n```\\n\\nProfiles will be stored as `/path/to/profile.<worker_pid>`.\\n\\n## Directives\\n\\n### google_perftools_profiles\\n\\n- **Syntax:** `google_perftools_profiles file;`\\n- **Default:** \u2014\\n- **Context:** `main`\\n\\nSets a file name that keeps profiling information of nginx worker process. The ID of the worker process is always a part of the file name and is appended to the end of the file name, after a dot.\\n"\n    }\n]\n'})}),"\n",(0,t.jsx)(n.admonition,{title:"Limitations",type:"warning",children:(0,t.jsxs)(n.p,{children:["The sharepoint connector does not yet support creating a dataset from a single file (e.g. an Excel spreadsheet). Datasets must be created from a folder of documents (see ",(0,t.jsx)(n.a,{href:"/components/data-connectors/#document-support",children:"Document Support"}),")."]})}),"\n",(0,t.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"sharepoint_client_id"}),": Required. The client ID of the Azure AD (Entra) application."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"sharepoint_tenant_id"}),": Required. The tenant ID of the Azure AD (Entra) application."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"sharepoint_client_secret"}),": Optional. For service principal authentication. The client secret of the Azure AD (Entra) application."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"sharepoint_auth_code"}),": Optional. For user authentication. The authorization code obtained from the OAuth2 flow (see ",(0,t.jsx)(n.code,{children:"spice login sharepoint"})," ",(0,t.jsx)(n.a,{href:"/cli/reference/login",children:"docs"}),")."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Note: Only one of ",(0,t.jsx)(n.code,{children:"sharepoint_client_secret"})," or ",(0,t.jsx)(n.code,{children:"sharepoint_auth_code"})," is allowed."]}),"\n",(0,t.jsxs)(n.h3,{id:"from-formats",children:[(0,t.jsx)(n.code,{children:"from"})," formats"]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"from"})," field in a Sharepoint dataset takes the following format:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"from: 'sharepoint:<drive_type>:<drive_id>/<subpath_type>:<subpath_value>'\n"})}),"\n",(0,t.jsx)(n.h4,{id:"drives",children:"Drives"}),"\n",(0,t.jsx)(n.p,{children:"The sharepoint connector supports datasets from a variety of sources:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Drives: A user's OneDrive or a document library in SharePoint."}),"\n",(0,t.jsxs)(n.li,{children:["From the drive's name: ",(0,t.jsx)(n.code,{children:"from: sharepoint:drive:Documents/..."})]}),"\n",(0,t.jsxs)(n.li,{children:["From the drive's ID: ",(0,t.jsx)(n.code,{children:"from: sharepoint:driveId:b!Mh8opUGD80ec7zGXgX9r/..."})]}),"\n",(0,t.jsx)(n.li,{children:"Sites: A SharePoint site's default document library."}),"\n",(0,t.jsxs)(n.li,{children:["From the site's name: ",(0,t.jsx)(n.code,{children:"from: sharepoint:site:MySite/..."})]}),"\n",(0,t.jsxs)(n.li,{children:["From the site's ID: ",(0,t.jsx)(n.code,{children:"from: sharepoint:siteId:b!Mh8opUGD80ec7zGXgX9r/..."})]}),"\n",(0,t.jsxs)(n.li,{children:["User Drives: A user's OneDrive, ",(0,t.jsx)(n.code,{children:"from: sharepoint:me/..."}),". In this case, no ",(0,t.jsx)(n.code,{children:"drive_id"})," is specified. The user is identified based on the provided authentication."]}),"\n",(0,t.jsx)(n.li,{children:"Group Drives: A Group's default document library ( a Microsoft Entra, 365 group, or security group)."}),"\n",(0,t.jsxs)(n.li,{children:["From the group's name: ",(0,t.jsx)(n.code,{children:"from: sharepoint:group:MyGroup/..."})]}),"\n",(0,t.jsxs)(n.li,{children:["From the group's ID: ",(0,t.jsx)(n.code,{children:"from: sharepoint:groupId:b!Mh8opUGD80ec7zGXgX9r/..."})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["For a name-based ",(0,t.jsx)(n.code,{children:"drive_id"}),", the connector will attempt to resolve the name to an ID at startup."]}),"\n",(0,t.jsx)(n.h4,{id:"subpaths",children:"Subpaths"}),"\n",(0,t.jsx)(n.p,{children:"Within a drive, the sharepoint connector can load documents from:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The root folder: ",(0,t.jsx)(n.code,{children:"from: sharepoint:me/root"}),". In this case, no ",(0,t.jsx)(n.code,{children:"subpath_value"})," is specified."]}),"\n",(0,t.jsxs)(n.li,{children:["A specific path: ",(0,t.jsx)(n.code,{children:"from: sharepoint:me/path:/top_secrets"})," (",(0,t.jsx)(n.code,{children:"path"})," being the keyword)."]}),"\n",(0,t.jsxs)(n.li,{children:["A specific folder ID: ",(0,t.jsx)(n.code,{children:"from: sharepoint:me/id:01QM2NJSNHBISUGQ52P5AJQ3CBNOXDMVNT"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,t.jsxs)(n.p,{children:["As outlined in the ",(0,t.jsx)(n.a,{href:"#parameters",children:"connector parameters"}),", the Sharepoint connector supports two types of authentication:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Service principal authentication, by setting the ",(0,t.jsx)(n.code,{children:"sharepoint_client_secret"})," parameters."]}),"\n",(0,t.jsxs)(n.li,{children:["User authentication, by setting the ",(0,t.jsx)(n.code,{children:"sharepoint_auth_code"})," parameter. Generally this is obtained by running ",(0,t.jsx)(n.code,{children:"spice login sharepoint"})," and following the OAuth2 flow."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"creating-an-enterprise-application",children:"Creating an Enterprise Application"}),"\n",(0,t.jsxs)(n.p,{children:["To use the Sharepoint connector with service principal authentication, you will need to create an Azure AD application and grant it the necessary permissions. This will also support OAuth2 authentication for users within the tenant (i.e. ",(0,t.jsx)(n.code,{children:"params.sharepoint_auth_code"}),")."]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Create a new Azure AD application in the ",(0,t.jsx)(n.a,{href:"https://portal.azure.com/#view/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/~/Overview",children:"Azure portal"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Under the application's ",(0,t.jsx)(n.code,{children:"API permissions"}),", add the following permissions: ",(0,t.jsx)(n.code,{children:"Sites.Read.All"}),", ",(0,t.jsx)(n.code,{children:"Files.Read.All"}),", ",(0,t.jsx)(n.code,{children:"User.Read"}),", ",(0,t.jsx)(n.code,{children:"GroupMember.Read.All"})]}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"For service principal authentication, Application permissions are required. For user authentication, only delegated permissions are required."}),"\n"]}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:["Add ",(0,t.jsx)(n.code,{children:"sharepoint_client_id"})," and ",(0,t.jsx)(n.code,{children:"sharepoint_tenant_id"})," to the connector configuration."]}),"\n",(0,t.jsxs)(n.li,{children:["(For service principal authentication): Under the application's ",(0,t.jsx)(n.code,{children:"Certificates & secrets"}),", create a new client secret. Use this in ",(0,t.jsx)(n.code,{children:"params.sharepoint_client_secret"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"default-spice-application",children:"Default Spice Application"}),"\n",(0,t.jsx)(n.p,{children:"For convenience, Spice AI maintains a default Azure AD application that can be used for Sharepoint authentication. This application requires OAuth2 authentication. To use it:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"datasets:\n  - from: sharepoint:me/root # Set the drive and subpath as needed.\n    name: my_data\n    params:\n      sharepoint_client_id: f2b3116e-b4c4-464f-80ec-73cd9d9886b4\n      sharepoint_tenant_id: #{env:TENANT_ID}\n      sharepoint_auth_code: ${secrets:SPICE_SHAREPOINT_AUTH_CODE}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["And set the ",(0,t.jsx)(n.code,{children:"SPICE_SHAREPOINT_AUTH_CODE"})," secret via:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"spice login sharepoint --tenant-id $TENANT_ID --client-id f2b3116e-b4c4-464f-80ec-73cd9d9886b4\n"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>a});var t=i(6540);const o={},r=t.createContext(o);function s(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);