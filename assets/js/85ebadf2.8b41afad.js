"use strict";(self.webpackChunkspiceaidocs=self.webpackChunkspiceaidocs||[]).push([[5660],{8246:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>l});var a=s(4848),r=s(8453);const i={title:"Grafana & Prometheus",sidebar_label:"Grafana & Prometheus",description:"Monitoring Spice instances with Grafana & Prometheus",pagination_prev:"clients/index",pagination_next:null},t=void 0,o={id:"clients/grafana/index",title:"Grafana & Prometheus",description:"Monitoring Spice instances with Grafana & Prometheus",source:"@site/docs/clients/grafana/index.md",sourceDirName:"clients/grafana",slug:"/clients/grafana/",permalink:"/clients/grafana/",draft:!1,unlisted:!1,editUrl:"https://github.com/spiceai/docs/tree/trunk/spiceaidocs/docs/clients/grafana/index.md",tags:[],version:"current",frontMatter:{title:"Grafana & Prometheus",sidebar_label:"Grafana & Prometheus",description:"Monitoring Spice instances with Grafana & Prometheus",pagination_prev:"clients/index",pagination_next:null},sidebar:"tutorialSidebar",previous:{title:"Clients and Tools",permalink:"/clients/"}},c={},l=[];function d(e){const n={a:"a",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["The Spice runtime has a Prometheus endpoint configured by default on port ",(0,a.jsx)(n.code,{children:"9091"}),". There's also prebuilt Grafana dashboards for out of the box monitoring of all your Spice instances. This tutorial creates and configures Grafana and Prometheus to scrape and display metrics from several Spice instances. It assumes:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Two Spice runtimes, ",(0,a.jsx)(n.code,{children:"spiced-main"})," and ",(0,a.jsx)(n.code,{children:"spiced-edge"}),", are running on ",(0,a.jsx)(n.code,{children:"127.0.0.1:9091"})," and ",(0,a.jsx)(n.code,{children:"127.0.0.1:9092"})," respectively."]}),"\n"]}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Create a ",(0,a.jsx)(n.code,{children:"compose.yaml"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'version: "3"\nservices:\nprometheus:\n    image: prom/prometheus:latest\n    volumes:\n    - ./prometheus.yaml:/etc/prometheus/prometheus.yml\n    ports:\n    - 9090:9090\n    network_mode: "host"\ngrafana:\n    image: grafana/grafana:latest\n    volumes:\n    - ./.grafana/provisioning:/etc/grafana/provisioning\n    ports:\n    - 3000:3000\n    network_mode: "host"\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Create a ",(0,a.jsx)(n.code,{children:"prometheus.yaml"})," to"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"global:\nscrape_interval: 1s\nscrape_configs:\n- job_name: spiced-main\n    static_configs:\n    - targets: ['127.0.0.1:9091']\n- job_name: spiced-edge\n    static_configs:\n    - targets: ['127.0.0.1:9092']\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Add a prometheus as a source to grafana. Create a ",(0,a.jsx)(n.code,{children:".grafana/provisioning/datasources/prometheus.yml"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"apiVersion: 1\n\ndatasources:\n- name: Prometheus\n    type: prometheus\n    access: proxy\n    url: http://localhost:9090\n    isDefault: true\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Run the Docker Compose"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"docker-compose up\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Go to ",(0,a.jsx)(n.code,{children:"http://localhost:3000/dashboard/import"})," and add the JSON from ",(0,a.jsx)(n.a,{href:"https://github.com/spiceai/spiceai/blob/trunk/monitoring/grafana-dashboard.json",children:"monitoring/grafana-dashboard.json"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"The dashboard will have data from the Spice runtimes."}),"\n"]}),"\n"]}),"\n",(0,a.jsx)("img",{src:"/img/grafana/screenshot.png"})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>o});var a=s(6540);const r={},i=a.createContext(r);function t(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);