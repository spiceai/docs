"use strict";(self.webpackChunkspiceaidocs=self.webpackChunkspiceaidocs||[]).push([[947],{5999:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>l});var t=r(4848),n=r(8453);const i={title:"Secret Stores",sidebar_label:"Secret Stores",description:"",sidebar_position:8},c=void 0,o={id:"secret-stores/index",title:"Secret Stores",description:"",source:"@site/docs/secret-stores/index.md",sourceDirName:"secret-stores",slug:"/secret-stores/",permalink:"/secret-stores/",draft:!1,unlisted:!1,editUrl:"https://github.com/spiceai/docs/tree/trunk/spiceaidocs/docs/secret-stores/index.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{title:"Secret Stores",sidebar_label:"Secret Stores",description:"",sidebar_position:8},sidebar:"tutorialSidebar",previous:{title:"SQLite Data Accelerator",permalink:"/data-accelerators/sqlite"},next:{title:"CLI",permalink:"/cli/"}},a={},l=[{value:"File Secret Store",id:"file-secret-store",level:3},{value:"Environment Secret Store",id:"environment-secret-store",level:3},{value:"Kubernetes Secret Store",id:"kubernetes-secret-store",level:3},{value:"Keyring Secret Store",id:"keyring-secret-store",level:3}];function d(e){const s={code:"code",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.p,{children:["A secret store is a location where ",(0,t.jsx)(s.code,{children:"secret"})," objects are stored, which are used to store sensitive data, like a passwords, a tokens, or keys."]}),"\n",(0,t.jsxs)(s.p,{children:["Spice.ai supports four types of secret stores: ",(0,t.jsx)(s.code,{children:"file"}),", ",(0,t.jsx)(s.code,{children:"env"}),", ",(0,t.jsx)(s.code,{children:"kubernetes"})," and ",(0,t.jsx)(s.code,{children:"keyring"}),". The type of secret store is specified in the ",(0,t.jsx)(s.code,{children:"store"})," field of the ",(0,t.jsx)(s.code,{children:"secrets"})," section in the Spicepod manifest."]}),"\n",(0,t.jsx)(s.h3,{id:"file-secret-store",children:"File Secret Store"}),"\n",(0,t.jsxs)(s.p,{children:["Default secret store uses a file located at ",(0,t.jsx)(s.code,{children:"~/.spice/auth"}),".\nThe Spice.ai CLI offers the ",(0,t.jsx)(s.code,{children:"spice login"})," command to streamline credential storage. When logging into Spice.ai, it automatically saves credentials in the secret store file under ",(0,t.jsx)(s.code,{children:"spiceai"})," secret."]}),"\n",(0,t.jsx)(s.h3,{id:"environment-secret-store",children:"Environment Secret Store"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"env"})," store type allows Spice.ai to read secrets from environment variables. The environment variables should be formatted like ",(0,t.jsx)(s.code,{children:"SPICE_SECRET_<secret-name>_<secret-value-key>"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["All variables with the same prefix ",(0,t.jsx)(s.code,{children:"SPICE_SECRET_<secret-name>"})," are combined into a single secret. This allows you to group related secret values under a single secret name."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Example"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-yaml",children:"secrets:\n  store: env\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Setting ",(0,t.jsx)(s.code,{children:"spiceai"})," secret with spice.ai API key in ",(0,t.jsx)(s.code,{children:"key"})," secret value:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'SPICE_SECRET_SPICEAI_KEY="343533|**************" \\\n  spice run\n'})}),"\n",(0,t.jsx)(s.h3,{id:"kubernetes-secret-store",children:"Kubernetes Secret Store"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"kubernetes"})," store type allows Spice.ai to read Kubernetes secrets."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-yaml",children:"secrets:\n  store: kubernetes\n"})}),"\n",(0,t.jsx)(s.p,{children:"Note: This method requires the Kubernetes service account, which is running the Spice.ai pod, to have extended roles for secrets API access. Make sure to configure this service account with the necessary permissions to read secrets from the Kubernetes API."}),"\n",(0,t.jsx)(s.p,{children:"Example of Kubernetes role configuration for a custom service account:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-yaml",children:"kind: Role\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: spiced-account-role\nrules:\n  - apiGroups: ['']\n    resources: ['secrets']\n    verbs: ['get']\n"})}),"\n",(0,t.jsx)(s.h3,{id:"keyring-secret-store",children:"Keyring Secret Store"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"keyring"})," store allows Spice.ai to access secrets from the secure store of the host operating system:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"On Linux, it uses the secret-service and kernel keyutils."}),"\n",(0,t.jsx)(s.li,{children:"On macOS, it uses the keychain."}),"\n",(0,t.jsx)(s.li,{children:"On Windows, it uses the credential manager."}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["The keyring store will read entries name to be formatted as ",(0,t.jsx)(s.code,{children:"spice_secret_<secret-name>"}),", and entry account or user should be set to ",(0,t.jsx)(s.code,{children:"spiced"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"Note: secret values required to be stored as JSON strings for compatibility with Spice.ai secret objects, as the keyring store supports only string values."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Example"})}),"\n",(0,t.jsxs)(s.p,{children:["For setting ",(0,t.jsx)(s.code,{children:"spiceai"})," api key secret using macOS keychain, create new keychain entry, with following JSON string value"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'"{ key: "<your spice.ai app api key>" }"\n'})}),"\n",(0,t.jsx)("img",{src:"/img/secrets-keychain-example.png",alt:"",width:"800"}),"\n",(0,t.jsxs)(s.p,{children:["Then set ",(0,t.jsx)(s.code,{children:"store"})," field of the ",(0,t.jsx)(s.code,{children:"secrets"})," section in the Spicepod manifest:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-yaml",children:"secrets:\n  store: keyring\n"})})]})}function h(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,s,r)=>{r.d(s,{R:()=>c,x:()=>o});var t=r(6540);const n={},i=t.createContext(n);function c(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:c(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);