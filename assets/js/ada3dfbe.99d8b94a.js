"use strict";(self.webpackChunkspiceaidocs=self.webpackChunkspiceaidocs||[]).push([[3441],{3603:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>c});var i=n(4848),o=n(8453);const s={title:"Datadog",sidebar_label:"Datadog",description:"Monitoring Spice with Datadog",pagination_prev:"clients/index",sidebar_position:3,pagination_next:null},a=void 0,r={id:"clients/Datadog/index",title:"Datadog",description:"Monitoring Spice with Datadog",source:"@site/docs/clients/Datadog/index.md",sourceDirName:"clients/Datadog",slug:"/clients/Datadog/",permalink:"/clients/Datadog/",draft:!1,unlisted:!1,editUrl:"https://github.com/spiceai/docs/tree/trunk/spiceaidocs/docs/clients/Datadog/index.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Datadog",sidebar_label:"Datadog",description:"Monitoring Spice with Datadog",pagination_prev:"clients/index",sidebar_position:3,pagination_next:null},sidebar:"docsSidebar",previous:{title:"Clients and Tools",permalink:"/clients/"}},d={},c=[{value:"Metrics Endpoint Configuration",id:"metrics-endpoint-configuration",level:2},{value:"Datadog Agent Configuration",id:"datadog-agent-configuration",level:2},{value:"Import the Spice Datadog Dashboard",id:"import-the-spice-datadog-dashboard",level:2}];function l(e){const t={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.p,{children:["Spice can be monitored with ",(0,i.jsx)(t.a,{href:"https://www.datadoghq.com/",children:"Datadog"})," using the ",(0,i.jsx)(t.a,{href:"https://prometheus.io/docs/instrumenting/exposition_formats/#basic-info",children:"Spice Metrics Endpoint"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"metrics-endpoint-configuration",children:"Metrics Endpoint Configuration"}),"\n",(0,i.jsxs)(t.p,{children:["The metrics endpoint uses port ",(0,i.jsx)(t.code,{children:"9000"})," by default. The metrics endpoint configuration is logged at startup."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"2024-07-15T21:48:00.158267Z  INFO spiced: Metrics listening on 127.0.0.1:9000\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Pass the ",(0,i.jsx)(t.code,{children:"--metrics"})," parameter to bind to a specific port. For example, to bind to port ",(0,i.jsx)(t.code,{children:"9090"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:" spiced --metrics 0.0.0.0:9090\n"})}),"\n",(0,i.jsx)(t.p,{children:"or when using Docker:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-Dockerfile",children:'FROM spiceai/spiceai:latest\n\n# Docker configuration ...\n\n# Configure the metrics endpoint on port 9090\nCMD ["--metrics", "0.0.0.0:9090"]\nEXPOSE 9090\n'})}),"\n",(0,i.jsx)(t.p,{children:"Configuration of the metrics endpoint can be verified using a HTTP GET request, for example:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:'curl http://localhost:9000/metrics\n\n# TYPE spiced_runtime_http_server_start counter\nspiced_runtime_http_server_start 1\n\n# TYPE spiced_runtime_flight_server_start counter\nspiced_runtime_flight_server_start 1\n\n# TYPE datasets_count gauge\ndatasets_count{engine="None"} 1\ndatasets_count{engine="arrow"} 1\n...\n'})}),"\n",(0,i.jsx)(t.h2,{id:"datadog-agent-configuration",children:"Datadog Agent Configuration"}),"\n",(0,i.jsxs)(t.p,{children:["Prerequisite: ",(0,i.jsx)(t.a,{href:"https://docs.datadoghq.com/getting_started/agent/",children:"Datadog Agent version 6.5.0 or later is installed"}),"."]}),"\n",(0,i.jsx)(t.p,{children:"Configure the Datadog Agent to scrape the Spice metrics endpoint:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Edit the ",(0,i.jsx)(t.code,{children:"openmetrics.d/conf.yaml"})," file in the ",(0,i.jsx)(t.code,{children:"conf.d/"})," folder at the root of your ",(0,i.jsx)(t.a,{href:"https://docs.datadoghq.com/agent/guide/agent-configuration-files/#agent-configuration-directory",children:"Agent\u2019s configuration directory"}),":"]}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",children:"init_config:\n\ninstances:\n    - prometheus_url: SPICE-METRICS-ENDPOINT>/metrics # for example http://localhost:9000/metrics\n      namespace: spice\n      metrics:\n          - '*'\n"})}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.a,{href:"https://docs.datadoghq.com/agent/guide/agent-commands/#start-stop-and-restart-the-agent",children:"Restart the Agent"})," to start collecting Spice metrics."]}),"\n",(0,i.jsxs)(t.li,{children:["Refer to ",(0,i.jsx)(t.a,{href:"https://docs.datadoghq.com/integrations/guide/prometheus-host-collection/",children:"Prometheus and OpenMetrics metrics collection from a host"})," for all available configuration options and supported parameters."]}),"\n",(0,i.jsxs)(t.li,{children:["Open Datadog Metrics Explorer and type ",(0,i.jsx)(t.code,{children:"spice"})," to confirm Spice telemetry information is successfully collected."]}),"\n"]}),"\n",(0,i.jsx)("img",{width:"800",src:"/img/datadog/spice_datadog_metrics_explorer.png"}),"\n",(0,i.jsx)(t.h2,{id:"import-the-spice-datadog-dashboard",children:"Import the Spice Datadog Dashboard"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Create ",(0,i.jsx)(t.a,{href:"https://docs.datadoghq.com/dashboards/#get-started",children:"New Datadog Dashboard"})]}),"\n"]}),"\n",(0,i.jsx)("img",{width:"800",src:"/img/datadog/spice_datadog_dashboard_new.png"}),"\n",(0,i.jsxs)(t.ol,{start:"2",children:["\n",(0,i.jsxs)(t.li,{children:["Click ",(0,i.jsx)(t.strong,{children:"Import dashboard JSON"})," and drag and drop ",(0,i.jsx)(t.a,{href:"https://raw.githubusercontent.com/spiceai/spiceai/trunk/monitoring/datadog-dashboard.json",children:"monitoring/datadog-dashboard.json"})," file"]}),"\n"]}),"\n",(0,i.jsx)("img",{width:"800",src:"/img/datadog/spice_datadog_dashboard_import.png"}),"\n",(0,i.jsxs)(t.ol,{start:"3",children:["\n",(0,i.jsx)(t.li,{children:"Dashbord is now configured to display Spice.ai OSS key performance metrics"}),"\n"]}),"\n",(0,i.jsx)("img",{width:"800",src:"/img/datadog/spice_datadog_dashboard.png"})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>r});var i=n(6540);const o={},s=i.createContext(o);function a(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);